<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Temporary jobs page">
  <title>Akalia</title>
  <%- include('../partials/head.ejs'); %>

</head>

<body>
  <%- include('../partials/navbar.ejs'); %>
    <main>
      <section class=" py-4 container d-flex align-items-center justify-content-center flex-column gap-3">
        <h2 class="mb-3 fw-semibold">Productos</h2>
        <div class="row col-10 col-md-12 d-flex align-items-center justify-content-center mx-md-5">
          <% if (typeof productos !=='undefined' && productos.length) { %>
            <% productos.forEach(producto=> { %>
              <% /* idParaRuta: usar _id o idProducto o id según exista en el objeto */ %>
              <% const idParaRuta = producto._id || producto.idProducto || producto.id || ''; %>
              <div onclick="showProductDetail('<%= idParaRuta %>')"
                class="cursor-pointer col-12 col-sm-6 col-md-4 col-lg-3 mb-4 d-flex align-items-stretch">
                <article class="card rounded-0 border-0 w-100 h-100">
                  <% /* Buscar imagen por id del producto (normalizar a string para comparar) */ %>
                  <% const img = imagenes.find(img => String(img.idProducto) === String(producto._id || producto.idProducto || producto.id)); %>
                    <% if(img) { %>
                      <!-- Mostrar la imagen encontrada, recortada con object-fit para mantener proporción -->
                      <img src="<%= img.urlImagen %>" class="card-img-top img-fluid rounded-0"
                        style="height:200px; object-fit:cover;" alt="<%= producto.nombreProducto %>" />
                      <% } else { %>
                        <!-- Si no hay imagen asociada, mostrar placeholder -->
                        <img
                          src="https://img.freepik.com/vector-premium/icono-marco-fotos-foto-vacia-blanco-vector-sobre-fondo-transparente-aislado-eps-10_399089-1290.jpg"
                          class="card-img-top img-fluid rounded-0"
                          style="height:200px; object-fit:cover;" alt="<%= producto.nombreProducto %>" />
                        <% } %>
                          <!-- <%= producto.imagenProducto %> -->
                          <div class="card-body bg-light d-flex flex-column">
                            <h5 class="card-title  mb-1 text-truncate w-100">
                              <%= producto.tituloProducto %>
                            </h5>
                            <p class="card-text text-muted mb-2 text-truncate w-100">
                              <%= producto.descripcionProducto %>
                            </p>
                            <p class="fw-semibold text-dark mb-0 mt-auto">
                              $ <%= producto.precio %>
                            </p>
                          </div>
                </article>
              </div>
              <% }); %>
                <% } else { %>
                  <li><span>Sin productos</span></li>
                  <% } %>
        </div>
      </section>

    </main>
    <!-- FOOTER-->
    <%- include('../partials/footer.ejs'); %>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
      <script src="/js/login_signup.js"></script>
      <script src="/js/captcha.js"></script>
      <script src="/js/landing.js"></script>
      <script src="/js/validaciones-login-signup.js"></script>

      <!-- Bootstrap + FontAwesome -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
</body>
<%- include('../partials/modal-login.ejs'); %>
  <%- include('../partials/modal-signup.ejs'); %>


</html>